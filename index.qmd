---
title: "Introdu√ß√£o ao Minicurso de Estat√≠stica Espacial"
author:
  - name: "Gean Pereira Damaceno"
    affiliation: "Departamento de Estat√≠stica - UFLA"
#date: 2026-06-14
lang: pt
---

::: {.column-margin style="text-align: center;"}
**Livro Base**

[![An√°lise de Dados Espaciais em R](Livros/livros.jpg){width=150px}](https://www.editoraufla.com.br/product-page/an%C3%A1lise-de-dados-espaciais-com-aplica%C3%A7%C3%B5es-em-r)
:::




**Introdu√ß√£o**


::: {.callout-note title="Sobre o minicurso"}
üìç Este minicurso apresenta m√©todos de **an√°lise espacial** em tr√™s contextos principais:

- üó∫Ô∏è **Dados agregados por √°reas**  
- üìå **Processos pontuais**  
- üåê **Geoestat√≠stica**

üéØ O p√∫blico-alvo inclui estudantes e profissionais com conhecimentos b√°sicos em **regress√£o** e **estat√≠stica espacial**.

üìò O material √© baseado no livro *An√°lise de Dados Espaciais com Aplica√ß√µes em R* (Scalon, 2024) e conta com **exemplos pr√°ticos** e **exerc√≠cios** ao final de cada se√ß√£o.
:::






Este minicurso apresenta m√©todos para an√°lises espacial em tr√™s contextos: dados agregados por √°reas, processos pontuais e geoestat√≠stica. O p√∫blico-alvo s√£o todos com conhecimentos b√°sicos em regress√£o e estat√≠stica espacial. O material √© baseado no livro ‚ÄúAn√°lise de Dados Espaciais com Aplica√ß√µes em R‚Äù (Scalon, 2024) e inclui exemplos pr√°ticos e exerc√≠cios para cada se√ß√£o.



### Instala√ß√£o e execu√ß√£o

Instale os pacotes necess√°rios em uma sess√£o R (ajuste conforme sua vers√£o):

```{r}
#| eval: false
#| code-fold: true
#| code-summary: "Instala√ß√£o dos pacotes"
install.packages(c(
  "spdep", "spatialreg", "spatstat.core", "spatstat.geom", "gstat",
  "sp", "sf", "rgdal", "raster", "geoR", "dplyr"
))
```
Al√©m disso, instale o [Quarto](https://quarto.org/docs/get-started/) para renderizar este material.

Com `quarto` instalado, renderize o livro (ap√≥s todas as altera√ß√µes):

```powershell
quarto preview
```

### Como usar este material

Cada se√ß√£o deste livro est√° em seu pr√≥prio arquivo `.qmd`. Navegue pelos cap√≠tulos usando o menu √† esquerda.

---

## Estrutura do Minicurso (Se√ß√µes)

- **Se√ß√£o A ‚Äî Instala√ß√£o e Introdu√ß√£o:** pacotes, estrutura de arquivos, como renderizar.
- **Se√ß√£o B ‚Äî Dados de √Åreas:** teoria, matrizes de pesos, Moran's I, SAR/SEM, exemplos em R, exerc√≠cios.
- **Se√ß√£o C ‚Äî Processos Pontuais:** Poisson inhomog√™neo, LGCP, ajuste com `spatstat`, exerc√≠cios.
- **Se√ß√£o D ‚Äî Geoestat√≠stica:** variogramas, ajuste, krigagem universal, predi√ß√£o, exerc√≠cios.
- **Se√ß√£o E ‚Äî Espa√ßo-Temporal (opcional):** esbo√ßo de modelagem espa√ßo-temporal e refer√™ncias.
- **Ap√™ndices:** solu√ß√µes dos exerc√≠cios, scripts auxiliares e refer√™ncia √∫nica ao livro.


---

## Exerc√≠cios

Se√ß√£o B ‚Äî Dados de √Åreas

1. Ajuste um modelo OLS `CRIME ~ INC + HOVAL` com `columbus`. Calcule Moran's I nos res√≠duos e interprete. (Dica: `lm.morantest()`)

2. Ajuste um SAR e um SEM para os mesmos dados. Compare os valores de AIC e interprete `rho` e `lambda`.

Se√ß√£o C ‚Äî Processos Pontuais

1. Usando `bei`, ajuste `ppm(bei ~ elev + grad, data = bei.extra)`. Quais covari√°veis s√£o significativas? Fa√ßa um P-P plot para avaliar ajuste.

2. Ajuste um `kppm(..., clusters = "LGCP")` e compare os par√¢metros do campo aleat√≥rio (sigma2 e escala) com o modelo Poisson.

Se√ß√£o D ‚Äî Geoestat√≠stica

1. Em `meuse`, ajuste uma tend√™ncia de `log(zinc) ~ sqrt(dist)` e calcule o variograma dos res√≠duos. Ajuste um modelo exponencial e reporte nugget, sill e range.

2. Realize krigagem universal para predizer `log(zinc)` em uma grade e produza um mapa de predi√ß√£o e outro de erro padr√£o.

Se√ß√£o E ‚Äî Espa√ßo-Temporal (exerc√≠cio conceitual)

1. Escreva um esbo√ßo de como separaria o variograma espa√ßo-temporal em componentes espa√ßo, tempo e intera√ß√£o para um conjunto de s√©ries de temperatura.

---

## Ap√™ndice A ‚Äî Solu√ß√µes (respostas r√°pidas)

Se√ß√£o B ‚Äî Dados de √Åreas (exemplo de solu√ß√£o)

```{.r}
# OLS e Moran
data(columbus)
b <- poly2nb(columbus)
listw <- nb2listw(nb, style = "W")
modelo_ols <- lm(CRIME ~ INC + HOVAL, data = columbus)
lm.morantest(modelo_ols, listw)

# SAR e SEM
modelo_sar <- lagsarlm(CRIME ~ INC + HOVAL, data = columbus, listw = listw)
modelo_sem <- errorsarlm(CRIME ~ INC + HOVAL, data = columbus, listw = listw)
AIC(modelo_ols, modelo_sar, modelo_sem)
```

Se√ß√£o C ‚Äî Processos Pontuais (exemplo de solu√ß√£o)

```{.r}
library(spatstat)
data(bei); data(bei.extra)
modelo_ppm <- ppm(bei ~ elev + grad, data = bei.extra)
summary(modelo_ppm)

modelo_lgcp <- kppm(bei ~ elev + grad, data = bei.extra, clusters = "LGCP")
summary(modelo_lgcp)
```

Se√ß√£o D ‚Äî Geoestat√≠stica (exemplo de solu√ß√£o)

```{.r}
library(gstat); library(sp)
data(meuse); coordinates(meuse)=~x+y
v <- variogram(log(zinc) ~ sqrt(dist), meuse)
vm <- fit.variogram(v, vgm(psill=1, model="Exp", range=300, nugget=0))
vm
# Krigagem (exemplo):
# meuse.grid <- ... (defina grade)
# kr <- krige(log(zinc) ~ sqrt(dist), meuse, meuse.grid, model = vm)
```

---

## Ap√™ndice B ‚Äî Scripts e Dados

- `script_com_covariaveis.R`: scripts com exemplos prontos de `spatstat` e `kppm`.
- `Script_geo_estatistica.R`: scripts de variograma e krigagem para `meuse`.
- `dados/`: cont√™m `Area_Jernimo_Contorno.kml` e outros dados de exemplo.

Coloque os scripts no mesmo diret√≥rio do projeto e execute bloco-a-bloco no RStudio para reproduzir resultados. Se quiser, eu posso gerar arquivos `scripts/` com vers√µes prontas das solu√ß√µes.

## Refer√™ncias

- Diggle, P.J. & Ribeiro, P.J. (2007). Model-based Geostatistics. Springer.  
- Illian, J., Penttinen, A., Stoyan, H., Stoyan, D. (2008). Statistical Analysis and Modelling of Spatial Point Patterns. Wiley.  
- Anselin, L. (1988). Spatial Econometrics: Methods and Models. Kluwer.